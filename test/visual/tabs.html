<!DOCTYPE html>
<html>
<head lang="en">
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1, viewport-fit=cover">
  <title>Tabs tests</title>
  <script>
    window.polymerSkipLoadingFontRoboto = true;
  </script>
</head>

<body>
  <style>
    html,
    body {
      height: 100%;
    }

    body {
      margin: 0;
    }

    vaadin-tab,
    vaadin-tab::before,
    vaadin-tab::after {
      transition: none !important;
    }
  </style>

  <vaadin-app-layout>
    <vaadin-drawer-toggle slot="navbar touch-optimized"></vaadin-drawer-toggle>
    <h2 slot="navbar touch-optimized">App Name</h2>
    <vaadin-tabs orientation="vertical" slot="drawer">
      <vaadin-tab>
        <a href="/">
          <iron-icon icon="lumo:calendar"></iron-icon>
          Page 1
        </a>
      </vaadin-tab>
      <vaadin-tab>
        <a href="page2">
          <iron-icon icon="lumo:user"></iron-icon>
          Page 2
        </a>
      </vaadin-tab>
      <vaadin-tab>
        <a href="page3">
          <iron-icon icon="lumo:phone"></iron-icon>
          Page 3
        </a>
      </vaadin-tab>
    </vaadin-tabs>
    <main>
      Page content
    </main>
  </vaadin-app-layout>

  <script type="module">
    import { cssFromModules } from '@polymer/polymer/lib/utils/style-gather.js';
    import '@vaadin/vaadin-lumo-styles/icons.js';

    (async() => {
      const themeQuery = window.location.search.replace(/.*theme=([\w\-]+).*/, '$1') || 'lumo';
      const touch = window.location.search.replace(/.*touch=(\w+).*/, '$1') || '';
      const [theme, variant] = themeQuery.split('-');

      const tabs = document.querySelector('vaadin-tabs');
      const layout = document.querySelector('vaadin-app-layout');

      await Promise.all([
        import('../../theme/' + theme + '/vaadin-drawer-toggle.js'),
        import('../../theme/' + theme + '/vaadin-app-layout.js'),
        import('@vaadin/vaadin-tabs/theme/' + theme + '/vaadin-tabs.js')
      ]);

      if (theme === 'lumo') {
        const style = document.createElement('style');
        style.textContent = cssFromModules('lumo-color') + cssFromModules('lumo-typography');
        document.head.appendChild(style);
      }

      if (variant === 'dark') {
        document.documentElement.setAttribute('theme', variant);
      }

      await Promise.all([
        tabs.updateComplete,
        layout.updateComplete,
        ...Array.from(tabs.children).map(tab => tab.updateComplete)
      ]);

      if (touch === 'true') {
        layout.setAttribute('touch-optimized', '');
      }

      window.requestAnimationFrame(() => {
        layout.dataset.ready = true;
      });
    })();
  </script>
</body>
</html>
